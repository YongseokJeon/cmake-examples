cmake_minimum_required(VERSION 3.0)

# load version header file as string
file(STRINGS "${CMAKE_CURRENT_SOURCE_DIR}/include/version.h" VERSION_DEFINE)
message(VERBOSE "Version header string: ${VERSION_DEFINE}")

# Major version
string(REGEX MATCH "VERSIONING_EXAMPLE_MAJOR [0-9]+" VERSION_MAJOR_DEFINE ${VERSION_DEFINE})
string(REGEX MATCH "[0-9]+" VERSION_MAJOR ${VERSION_MAJOR_DEFINE})
# Minor version
string(REGEX MATCH "VERSIONING_EXAMPLE_MINOR [0-9]+" VERSION_MINOR_DEFINE ${VERSION_DEFINE})
string(REGEX MATCH "[0-9]+" VERSION_MINOR ${VERSION_MINOR_DEFINE})
# Patch version
string(REGEX MATCH "VERSIONING_EXAMPLE_PATCH [0-9]+" VERSION_PATCH_DEFINE ${VERSION_DEFINE})
string(REGEX MATCH "[0-9]+" VERSION_PATCH ${VERSION_PATCH_DEFINE})

set(EXAMPLE_VERSION ${VERSION_MAJOR}.${VERSION_MINOR}.${VERSION_PATCH})
message(STATUS "EXAMPLE_VERSION: ${EXAMPLE_VERSION}")

project(VERSION_EXAMPLE VERSION ${EXAMPLE_VERSION})
